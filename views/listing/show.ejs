<% layout('/layout/boilerplate.ejs') -%>
<body>
    
    <div class="row">
        <div class="col-8 offset-3">
            <h2 class="head">All details</h2>
            </div>

       
  
    <div class="card listing-card  offset-3 " >
  <img src="<%=listing.image%>" class="card-img-top show-image" alt="photo">
  <b><%=listing.title%></b>
   
  <div class="card-body">

    <p class="card-text"> Owned by <%= listing.owner.username%></p>

    <p class="card-text"> <%= listing.description%> <br></p>
    <p class="card-text">&#x20B9;<%=listing.price.toLocaleString("en-IN")%> </p>
    <p class="card-text"> <%= listing.location%> <br></p>
    <p class="card-text"> <%= listing.country%></p>
     
      
 
  
  
   
    

    
  </div>
</div>
 
   </div>
  
    
   
    <div class="col-6 offset-3">
      <% if( currentuser && currentuser.equals(listing.owner._id) ){%>

 
   
        <div class="box">
         <a href="/listings/<%=listing._id%>/edit" class=" btn btn-dark " type="button">edit</a>

 
    <form method="POST" action= "/listings/<%=listing._id%>?_method=DELETE" >
    <button class=" btn btn-dark act btn-">Delete</button>
      </form>

    </div>
        <% }%>
  
    </div>
    <br>
    <hr>
       
<div class="row"> 
 


  <div class="col-8 offset-3">
    <%if(currentuser) {%>
    <form action="/listings/<%=listing._id%>/reviews" method="POST" novalidate class="needs-validation">
        <div class="mt-3">
      <label for="rating" class="form-label ">Rating</label>
      <input type="range" id="rating" name="review[rating] " class="form-control  form-range" min="1" max="5">
    </div>
    <div class="mt-3">
      <label for="review" class="form-label" >comment</label>
      <textarea id="review" rows="7" cols="40" class="form-control" name="review[comment]" required></textarea>
      <div class="invalid-feedback">opps! you haven't written anything</div>
      <div class="valid-feedback">Hmm go on brother</div>
    </div>
    <div class="mt-3"> <button class=" btn-outline-dark ">Submit</button></div>

    </form>
     <hr>
    <% }%>
   
    <p><b><h3>All Reviews</h3></b></p>
    <div class="row">
          <% for( review of listing.reviews){%>
     
            <div class="card  col-5 mt-3 mb-3 ms-3">
      <div class="card-body">
     <h1 class="card-title"><%=review.author.username%></h1>
     <p class="card-text"><%=review.comment%></p>
     <p class="card-text"><%=review.rating%>Star</p>
      </div>
      <form method="POST" action="/listings/<%=listing._id%>/reviews/<%=review._id %>?_method=DELETE">
        <button class="btn btn-dark mb-3" style="background-color: rgb(20, 14, 14);">Delete</button>
      </form>
    </div>

       
  
   

   <% }%>

    </div>
 
  

 
   
    
  

  </div>
</div>
   
    
    
   

   
   <br>
   <br>
    
    
   
   
   

 
     


    
</body>
